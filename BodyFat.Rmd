---
title: "BodyFat"
author: "Bowen Tian"
date: "10/9/2021"
output: html_document
---

```{r}
BodyFat<-read.csv("BodyFat.csv")
summary(BodyFat)
```

Unrealistic: 
BodyFat: min, max
Height: min

```{r}
BodyFat[c(which(BodyFat$BODYFAT<2),which(BodyFat$BODYFAT>40)),]
495/BodyFat$DENSITY[c(172,182,216)]-450
```

For 172, 182 and 216, the Bodyfat values are unrealistic. After we calculate the Bodyfat using the Density, the values are more extreme. Delete!

For 42, Height is unrealistic. Substitute Height by sqrt(Adiposity/Weight). 
```{r}
BodyFat[which.min(BodyFat$HEIGHT),]
BodyFat[42,6]<-sqrt(0.454*205/29.9)/0.0254
```

```{r}
boxplot((BodyFat$BODYFAT[-c(172,182,216)]-495/BodyFat$DENSITY[-c(172,182,216)]+450))
BodyFat[order((BodyFat$BODYFAT-495/BodyFat$DENSITY+450),decreasing = T)[c(1,2,252)],]
```

For 48, 76, 96, we can not determine whether Bodyfat or Density is incorrect. Delete!

```{r}
boxplot(0.454*BodyFat$WEIGHT/(0.0254*BodyFat$HEIGHT)^2-BodyFat$ADIPOSITY)
BodyFat[order((0.454*BodyFat$WEIGHT/(0.0254*BodyFat$HEIGHT)^2-BodyFat$ADIPOSITY),decreasing = T)[c(1,252)],]
```

For 163 and 221, we can not determine which of the Height, Weight and Adiposity is incorrect. Delete! 
```{r}
boxplot(0.454*BodyFat$WEIGHT[-c(163,221)]/(0.0254*BodyFat$HEIGHT[-c(163,221)])^2-BodyFat$ADIPOSITY[-c(163,221)])
```
 Although there stills some points that seem extreme in boxplot, the bias is only about 0.1. We don't view them as outliers. Keep!
 
For other variables, boxplot.


```{r}
B<-BodyFat[-c(48,76,96,163,172,182,216,221),][,-c(1,3)]
#View(B)
cor<-c()
for (i in 1:ncol(B)-1) {
 cor[i]<-cor(B[,1],B[,i+1]) 
}

corr<-as.data.frame(t(cor))
colnames(corr)<-colnames(B)[-1]
corr
```



 


